{"ast":null,"code":"import _slicedToArray from\"/Users/admin/Desktop/mpib-website/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{collection,addDoc,deleteDoc,doc}from\"firebase/firestore\";import{Body,Heading,Centering,Background,SubmitButton,FormElements}from'./styles';import{storage,db}from'../../base';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var UpdatePhotosForm=function UpdatePhotosForm(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),imageUpload=_useState2[0],setImageUpload=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),photoURL=_useState4[0],setPhotoURL=_useState4[1];var _useState5=useState([{}]),_useState6=_slicedToArray(_useState5,2),imgList=_useState6[0],setImgList=_useState6[1];var imgRef=storage.ref();var imgURLCollection=db.collection(\"photos\");useEffect(function(){var data=[];imgURLCollection.onSnapshot(function(snapshot){snapshot.docs.map(function(doc){data.push({id:doc.id,url:doc.data().url,name:doc.data().url.substring(92).split('?',1)[0]});});setImgList(data);});},[]);var handleDelete=function handleDelete(e){e.preventDefault();console.log(e.target.value);imgRef.child(\"/images/\".concat(e.target.name)).delete().then(function(){deleteDoc(doc(db,\"photos\",e.target.value)).then(function(){alert(\"success\");});}).catch(function(err){return console.log(err);});};var uploadURL=function uploadURL(url){addDoc(collection(db,'photos'),{url:url});};var uploadImage=function uploadImage(e){e.preventDefault();if(imageUpload==null)return;var storageRef=storage.ref();var uploadTask=storageRef.child(\"/images/\".concat(imageUpload.name)).put(imageUpload);uploadTask.on('state_changed',function(snapshot){console.log(snapshot);},function(err){console.log(err);},function(){storage.ref(\"/images\").child(imageUpload.name).getDownloadURL().then(function(url){console.log(\"File available at: \".concat(url));setPhotoURL(url);uploadURL(url);alert(\"success\");});});};return/*#__PURE__*/_jsx(Body,{children:/*#__PURE__*/_jsxs(Centering,{children:[/*#__PURE__*/_jsxs(Background,{children:[/*#__PURE__*/_jsx(Heading,{children:\"Add Images\"}),/*#__PURE__*/_jsxs(FormElements,{children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:function onChange(e){setImageUpload(e.target.files[0]);}}),/*#__PURE__*/_jsx(SubmitButton,{onClick:function onClick(e){return uploadImage(e);},children:\"Upload Image\"})]})]}),/*#__PURE__*/_jsxs(Background,{children:[/*#__PURE__*/_jsx(Heading,{children:\"Delete Images\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"ul\",{style:{'listStyle':'none'},children:imgList.map(function(item,index){return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"label\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){return handleDelete(e);},name:item.name,value:item.id,children:item.name})})},index);})})})]})]})});};export default UpdatePhotosForm;","map":{"version":3,"sources":["/Users/admin/Desktop/mpib-website/frontend/src/components/UpdateForm/UpdatePhotosForm.js"],"names":["React","useState","useEffect","collection","addDoc","deleteDoc","doc","Body","Heading","Centering","Background","SubmitButton","FormElements","storage","db","UpdatePhotosForm","imageUpload","setImageUpload","photoURL","setPhotoURL","imgList","setImgList","imgRef","ref","imgURLCollection","data","onSnapshot","snapshot","docs","map","push","id","url","name","substring","split","handleDelete","e","preventDefault","console","log","target","value","child","delete","then","alert","catch","err","uploadURL","uploadImage","storageRef","uploadTask","put","on","getDownloadURL","files","item","index"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react'\nimport { collection, addDoc, deleteDoc, doc } from \"firebase/firestore\"; \nimport { Body, Heading, Centering, Background, SubmitButton, FormElements} from './styles'\nimport { storage, db } from '../../base'\n\nconst UpdatePhotosForm = () => {\n    const [imageUpload, setImageUpload] = useState(null)\n    const [photoURL, setPhotoURL] = useState('')\n    const [imgList, setImgList] = useState([{}])\n   \n    const imgRef = storage.ref()\n    const imgURLCollection = db.collection(\"photos\");\n  \n    useEffect(()=>{\n        const data = []\n        imgURLCollection.onSnapshot((snapshot)=>{\n            snapshot.docs.map((doc)=>{\n                data.push({\n                    id:doc.id,\n                    url:doc.data().url,\n                    name:doc.data().url.substring(92).split('?',1)[0]\n                })\n            })\n            \n            setImgList(data);\n        })\n    },[])\n\n    const handleDelete = (e) => {\n        e.preventDefault()\n        console.log(e.target.value)\n        imgRef.child(`/images/${e.target.name}`).delete().then(()=>{\n            deleteDoc(doc(db,\"photos\",e.target.value)).then(()=>{alert(\"success\")})\n        }).catch((err)=>console.log(err))\n    }\n\n    const uploadURL = (url) => {  \n        addDoc(collection(db,'photos'),{\n            url: url\n        })   \n    }\n    const uploadImage = (e) => {\n        e.preventDefault()\n        if(imageUpload==null) return;\n        const storageRef = storage.ref()\n        const uploadTask = storageRef.child(`/images/${imageUpload.name}`).put(imageUpload)\n        uploadTask.on('state_changed', \n            (snapshot)=>{\n                console.log(snapshot)  \n                \n            }, \n            (err)=>{\n                console.log(err)\n            }, \n            ()=>{\n            storage\n                .ref(\"/images\")\n                .child(imageUpload.name)\n                .getDownloadURL()\n                .then((url)=>{\n                    console.log(`File available at: ${url}`)\n                    setPhotoURL(url);\n                    uploadURL(url);\n                    alert(\"success\")\n                });\n            \n            \n        })\n    }\n  return (\n    <Body>\n\n        <Centering>\n            <Background>\n                <Heading>Add Images</Heading>\n                <FormElements>\n                   \n                    <input type='file' onChange={(e)=>{setImageUpload(e.target.files[0])}}></input>\n                    <SubmitButton onClick={(e)=>uploadImage(e)}>Upload Image</SubmitButton>\n                   \n                </FormElements>\n                \n            </Background>\n\n\n            <Background>\n                <Heading>\n                    Delete Images\n                </Heading>\n                 <div>\n                    <ul style={{'listStyle':'none'}}>\n                    \n                    {imgList.map((item, index)=>{\n                              \n                                return(\n                                    <li key={index}>\n                                    \n                                    <label><button onClick={(e)=>handleDelete(e)} name={item.name} value={item.id}>{item.name}</button></label>\n                                    </li>\n                                )\n                            \n                        \n                        })}\n                    \n                    \n                        \n                    </ul>\n                    \n                    \n                    </div>\n            </Background>\n        </Centering>\n    </Body>\n  )\n}\n\nexport default UpdatePhotosForm"]},"metadata":{},"sourceType":"module"}